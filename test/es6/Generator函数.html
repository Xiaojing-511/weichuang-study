<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // Generator 函数是一个状态机，封装了多个内部状态。
        // 执行 Generator 函数会返回一个遍历器对象，也就是说，Generator 函数除了状态机，还是一个遍历器对象生成函数。
        // 返回的遍历器对象，可以依次遍历 Generator 函数内部的每一个状态。
        
        //形式上，Generator 函数是一个普通函数，但是有两个特征。
        // 一是，function关键字与函数名之间有一个星号；
        // 二是，函数体内部使用yield表达式，定义不同的内部状态

        // 必须调用遍历器对象的next方法，使得指针移向下一个状态。也就是说，每次调用next方法，内部指针就从函数头部或上一次停下来的地方开始执行，直到遇到下一个yield表达式（或return语句）为止。
        // 换言之，Generator 函数是分段执行的，yield表达式是暂停执行的标记，而next方法可以恢复执行


        function request() {
            console.log('world...');
            return 'world';
        }
        function* fn1() {
            console.log('start...');
            yield 'hello...';
            yield request();
            console.log('ending');
        }

        let f1 = fn1();   //会返回一个指针对象，需要调用next()继续执行
        // next方法返回一个对象,value表示yield后面的表达式的返回结果,如果没有return语句，则value属性的值为undefined
            // done属性的值false，表示遍历还没有结束
        console.log(f1.next()); //[value: 'hello...', done: false]
        console.log(f1.next()); //[value: 'world...', done: false]
        console.log(f1.next()); //[value: 'undefined', done: true]


        // function* fn4() {

        //     console.log('开始发送请求1');
        //     yield request1();

        //     console.log('开始发送请求2');
        //     yield request2();

        //     console.log('请求结束');
        // }

        // function request1() {
        //     setTimeout(() => {
        //         console.log('请求1成功');
        //         console.log(f4.next());
        //     }, 2000);
        //     return '请求1成功'
        // }

        // function request2() {
        //     setTimeout(() => {
        //         console.log('请求2成功');
        //         console.log(f4.next());
        //     }, 1000);
        //     return '请求2成功'
        // }

        // let f4 = fn4();
        // console.log(f4.next());

    </script>
</body>

</html>